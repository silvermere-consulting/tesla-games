---
import { getCollection } from "astro:content";
import SiteLayout from "../layouts/SiteLayout.astro";
import "../styles/global.css";

export const prerender = true;

const gameEntries = (await getCollection("games")).filter((entry) => !entry.data.exclude);
const guideEntries = (await getCollection("guides")).filter((entry) => !entry.data.exclude);

const featuredGameSlugs = [
  "cuphead",
  "stardew-valley",
  "beach-buggy-racing-2",
  "sonic-1",
  "cat-quest",
];
const popularGames = featuredGameSlugs
  .map((slug) => gameEntries.find((g) => g.slug === slug))
  .filter(Boolean);

const featuredGuideSlugs = ["steam-deck-vs-switch", "accessories", "rebuild-arcade"];
const featuredGuides = featuredGuideSlugs
  .map((slug) => guideEntries.find((g) => g.slug === slug))
  .filter(Boolean)
  .slice(0, 3);

const ogImage = popularGames[0]?.data.coverImage ?? "/favicon.svg";
const description = "Turn Tesla Arcade favourites into portable-ready libraries on Steam Deck, Switch, PC, iPad, and cloud gaming.";

const whatWeDo = [
  {
    title: "Platform availability",
    body: "Find Tesla Arcade equivalents on Steam, Switch, PlayStation, Xbox, iPad, and cloud.",
  },
  {
    title: "Cross-save & progression",
    body: "Know which versions keep your progress in sync across handhelds and home.",
  },
  {
    title: "Best devices",
    body: "Pick the right portable — Steam Deck, Switch, iPad, Android, or cloud-first setups.",
  },
  {
    title: "Verified affiliate links",
    body: "Only authorised stores and vetted accessories so you avoid knock-offs.",
  },
];

const playDestinations = [
  { title: "Steam Deck", href: "/guides/steam-deck", note: "Valve’s handheld + docked play" },
  { title: "Switch", href: "/guides/switch", note: "Family-friendly, offline, travel-ready" },
  { title: "iPad", href: "/guides/ipad", note: "Apple Arcade, cloud, and external controllers" },
  { title: "Android", href: "/guides/android", note: "Cloud, emulation, and Tesla-friendly options" },
  { title: "Cloud gaming", href: "/guides/cloud", note: "GeForce NOW, Xbox Cloud, and hotel Wi-Fi tips" },
];
---
<SiteLayout title="Games On The Move | Tesla Arcade Anywhere" description={description} ogImage={ogImage}>
  <section class="grid gap-10 lg:grid-cols-[1.1fr_0.9fr] items-center">
    <div class="space-y-6">
      <p class="inline-flex items-center gap-2 text-xs font-semibold uppercase tracking-[0.2em] text-slate-500">
        <span class="h-2 w-2 rounded-full bg-[var(--brand-blue)]"></span>
        Tesla Arcade → Portable gaming
      </p>
      <div class="space-y-4">
        <h1 class="text-4xl sm:text-5xl font-bold text-[var(--brand-slate)] leading-tight">Your Tesla Favourite Games — Now Playable Anywhere</h1>
        <p class="text-lg text-slate-600 max-w-2xl">
          Bring Tesla Arcade games to Steam Deck, Switch, iPad, PC, consoles and cloud. We map platform availability, cross-save paths, and the best hardware for travel-ready play.
        </p>
      </div>
      <div class="flex flex-wrap gap-4">
        <a href="/games" class="inline-flex items-center justify-center rounded-full bg-[var(--brand-blue)] px-6 py-3 text-white font-semibold shadow-lg shadow-blue-300/40">
          Browse game library
        </a>
        <a href="/guides/getting-started" class="inline-flex items-center justify-center rounded-full border border-slate-300 px-6 py-3 font-semibold text-[var(--brand-slate)]">
          Getting started guide
        </a>
      </div>
      <div class="grid gap-3 sm:grid-cols-2">
        <div class="rounded-2xl border border-slate-100 p-4 bg-slate-50">
          <p class="text-sm font-semibold text-slate-500">Platforms covered</p>
          <p class="text-lg font-bold text-[var(--brand-slate)]">Tesla · Deck · Switch · iPad · PC · Cloud</p>
        </div>
        <div class="rounded-2xl border border-slate-100 p-4 bg-slate-50">
          <p class="text-sm font-semibold text-slate-500">Cross-save focus</p>
          <p class="text-lg font-bold text-[var(--brand-slate)]">Move progress between devices</p>
        </div>
      </div>
    </div>

    <div class="bg-[var(--brand-slate)] text-white rounded-3xl p-8 shadow-md">
      <p class="text-sm uppercase tracking-widest text-white/70">What we do</p>
      <ul class="mt-4 space-y-4 text-base">
        {whatWeDo.map((item) => (
          <li class="flex gap-3">
            <span class="h-2.5 w-2.5 mt-2 rounded-full bg-[var(--brand-yellow)]"></span>
            <div>
              <p class="font-semibold">{item.title}</p>
              <p class="text-white/80 text-sm">{item.body}</p>
            </div>
          </li>
        ))}
      </ul>
    </div>
  </section>

  <section class="mt-16">
    <div class="flex items-baseline justify-between mb-4">
      <h2 class="text-2xl font-semibold text-[var(--brand-slate)]">Popular Tesla Arcade games</h2>
      <a class="text-sm font-semibold text-[var(--brand-blue)]" href="/games">View all games</a>
    </div>
    {popularGames.length === 0 ? (
      <p class="text-slate-500">No games found. Add files to <code>src/content/games/</code>.</p>
    ) : (
      <ul class="grid gap-5 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4">
        {popularGames.map((g) => (
          <li class="group border border-slate-100 rounded-2xl overflow-hidden bg-white hover:shadow-md transition">
            <a
              href={`/games/${g.slug}`}
              class="block"
              data-umami-event="game-card-click"
              data-umami-event-game={g.slug}
              data-umami-event-source="home"
            >
              {g.data.coverImage ? (
                <img
                  src={g.data.coverImage}
                  alt={`${g.data.title} cover`}
                  class="w-full aspect-[16/9] object-cover"
                  loading="lazy"
                  width="640"
                  height="360"
                />
              ) : (
                <div class="w-full aspect-[16/9] bg-slate-100 grid place-items-center text-slate-400 text-sm">
                  No image
                </div>
              )}
              <div class="p-4 space-y-1">
                <h3 class="font-semibold text-[var(--brand-slate)]">{g.data.title}</h3>
                <p class="text-xs text-slate-500">Where to play · cross-save tips</p>
                {g.data.tesla?.available ? (
                  <p class="text-xs text-emerald-700">Available in Tesla Arcade</p>
                ) : (
                  <p class="text-xs text-slate-500">Home/portable only</p>
                )}
              </div>
            </a>
          </li>
        ))}
      </ul>
    )}
  </section>

  <section class="mt-16">
    <div class="flex items-baseline justify-between mb-4">
      <h2 class="text-2xl font-semibold text-[var(--brand-slate)]">Where should you play?</h2>
      <a class="text-sm font-semibold text-[var(--brand-blue)]" href="/guides">See all guides</a>
    </div>
    <div class="grid gap-4 sm:grid-cols-2 lg:grid-cols-3">
      {playDestinations.map((dest) => (
        <a href={dest.href} class="rounded-2xl border border-slate-100 bg-white p-5 shadow-sm hover:-translate-y-0.5 hover:shadow-md transition">
          <div class="flex items-center justify-between mb-2">
            <p class="text-lg font-semibold text-[var(--brand-slate)]">{dest.title}</p>
            <span class="text-[var(--brand-blue)] font-semibold text-sm">Read guide →</span>
          </div>
          <p class="text-sm text-slate-600">{dest.note}</p>
        </a>
      ))}
    </div>
  </section>

  <section class="mt-16">
    <div class="flex items-baseline justify-between mb-4">
      <h2 class="text-2xl font-semibold text-[var(--brand-slate)]">Featured guides</h2>
      <a class="text-sm font-semibold text-[var(--brand-blue)]" href="/guides">View all</a>
    </div>
    {featuredGuides.length === 0 ? (
      <p class="text-slate-500">No guides yet. Add files to <code>src/content/guides/</code>.</p>
    ) : (
      <ul class="grid gap-5 sm:grid-cols-2 lg:grid-cols-3">
        {featuredGuides.map((g) => (
          <li class="rounded-2xl border border-slate-100 bg-white overflow-hidden shadow-sm hover:shadow-lg transition">
            <a
              href={`/guides/${g.slug}`}
              class="flex flex-col h-full"
              data-umami-event="Guide Card Click"
              data-umami-event-source="home"
              data-umami-event-guide={g.slug}
              data-umami-event-title={g.data.title}
            >
              {g.data.coverImage ? (
                <img src={g.data.coverImage} alt="" class="w-full aspect-[16/9] object-cover" loading="lazy" width="640" height="360" />
              ) : (
                <div class="w-full aspect-[16/9] bg-slate-100 grid place-items-center text-slate-400 text-sm">No image</div>
              )}
              <div class="p-4 space-y-2">
                <h3 class="font-semibold text-lg text-[var(--brand-slate)]">{g.data.title}</h3>
                {g.data.short && <p class="text-sm text-slate-600 line-clamp-2">{g.data.short}</p>}
                {g.data.updated && <p class="text-xs text-slate-500">Updated: {g.data.updated}</p>}
              </div>
            </a>
          </li>
        ))}
      </ul>
    )}
  </section>

  <p class="mt-16 text-xs text-slate-500">
    As an Amazon Associate and partner of other retailers, we may earn affiliate commissions from qualifying purchases.
  </p>
</SiteLayout>
